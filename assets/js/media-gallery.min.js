function foobar_gallery_popup(e,i,l,a,t,r,n){void 0==n&&(n=[]),void 0==r&&(r=!1);var o=jQuery(l),s=jQuery(a).find(t);jQuery(i).on("click","a",function(i){var l=jQuery(this);if(i.preventDefault(),e.a)return void e.a.open();e.a=wp.media.frames.listing_image_gallery=wp.media({title:l.data("choose"),button:{text:l.data("update")},states:[new wp.media.controller.Library({title:l.data("choose"),filterable:"all",multiple:!0})]}),e.a.on("select",function(){var i=e.a.state().get("selection"),a=o.val();i.map(function(e){if(e=e.toJSON(),e.id&&r){var i=e.url.split(".")[e.url.split(".").length-1],t=check_types(n,i);if(1!=t)return void wrong_filetype(t);a=a?a+","+e.id:e.id;var o=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url;s.append('<li class="image" data-attachment_id="'+e.id+'"><img src="'+o+'" /><ul class="actions"><li><a href="#" class="delete" title="'+l.data("delete")+'">'+l.data("text")+"</a></li></ul></li>")}else if(e.id){var i=e.url.split(".")[e.url.split(".").length-1].toLowerCase(),t=check_types(n,i);if(1!=t)return void wrong_filetype(t);a=a?a+","+e.id:e.id;var c;c="xls"==i||"xlsx"==i?"/wp-includes/images/media/spreadsheet.png":"/wp-includes/images/media/document.png",s.append('<li class="image" data-attachment_id="'+e.id+'"><img src="'+c+'" /><div class="filename"><div>'+e.filename+'</div></div><ul class="actions"><li><a href="#" class="delete" title="'+l.data("delete")+'">'+l.data("text")+"</a></li></ul></li>")}}),o.val(a)}),e.a.open()}),jQuery(a).find(t).sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(e,i){i.item.css("background-color","#f6f6f6 ")},stop:function(e,i){i.item.removeAttr("style")},update:function(){var e="";jQuery(image_gallery_container).find("ul li.image").css("cursor","default").each(function(){var i=jQuery(this).attr("data-attachment_id");e=e+i+","}),o.val(e)}}),jQuery(a).on("click","a.delete",function(){jQuery(this).closest("li.image").remove();var e="";return jQuery(a).find("ul li.image").css("cursor","default").each(function(){var i=jQuery(this).attr("data-attachment_id");e=e+i+","}),o.val(e),jQuery("#tiptip_holder").removeAttr("style"),jQuery("#tiptip_arrow").removeAttr("style"),!1})}function wrong_filetype(e){jQuery(".wrong-filetype").remove(),jQuery('<div class="notice notice-error wrong-filetype"><h2>'+e+"</h2></div>").insertAfter(jQuery(".wp-header-end")),jQuery("html, body").animate({scrollTop:0},"fast")}function check_types(e,i){for(var l=0;l<e.length&&i!=e[l];l++)if(l===e.length-1){for(var a="Only files ending with a ",t=0;t<e.length;t++)t===e.length-1&&1!==e.length&&(a+=" or "),a+=e[t],t!==e.length-1&&2!==e.length&&(a+=", ");return a+=" extension are accepted in this field."}return!0}var listing_image_gallery_frame=new Object,image_gallery_link=".add_listing_images",image_gallery_id="#listing_image_gallery",image_gallery_container="#listing_images_container",image_gallery_listing="ul.listing_images",image_types=["png","jpg","jpeg","gif","svg"];foobar_gallery_popup(listing_image_gallery_frame,image_gallery_link,image_gallery_id,image_gallery_container,image_gallery_listing,!0,image_types);var listing_doc_gallery_frame=new Object,doc_gallery_link=".add_listing_docs",doc_gallery_id="#listing_doc_gallery",doc_gallery_container="#listing_docs_container",doc_gallery_listing="ul.listing_docs",doc_types=["doc","docx","xls","xlsx","pdf"];foobar_gallery_popup(listing_doc_gallery_frame,doc_gallery_link,doc_gallery_id,doc_gallery_container,doc_gallery_listing,!1,doc_types);